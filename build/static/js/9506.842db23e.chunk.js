"use strict";(self.webpackChunkmyapp=self.webpackChunkmyapp||[]).push([[9506],{9612:(e,s,a)=>{a.r(s),a.d(s,{default:()=>u});var r=a(9379),t=a(5043),i=a(7488),n=(a(2342),a(184)),l=a(3862),o=a(8537),d=a(579);function c(e){let{isOpen:s,onClose:a,onSave:n}=e;const[o,c]=(0,t.useState)({name:"",email:"",password:"",status:"active",permissions:[]}),[u,m]=(0,t.useState)(!1),[h,p]=(0,t.useState)(!1);(0,t.useEffect)(()=>{s&&(c({name:"",email:"",password:"",status:"active",permissions:[]}),p(!1))},[s]);const x=e=>{const{name:s,value:a}=e.target;c(e=>(0,r.A)((0,r.A)({},e),{},{[s]:a}))},j=e=>{const{value:s,checked:a}=e.target;c(e=>{const t=e.permissions;return a?(0,r.A)((0,r.A)({},e),{},{permissions:[...t,s]}):(0,r.A)((0,r.A)({},e),{},{permissions:t.filter(e=>e!==s)})})};return s?(0,d.jsx)("div",{className:"modal-overlay",children:(0,d.jsxs)("div",{className:"add-user-modal",children:[(0,d.jsxs)("div",{className:"modal-header",children:[(0,d.jsx)("h3",{children:"Add New User"}),(0,d.jsx)("button",{className:"close-btn",onClick:a,disabled:u,children:"\xd7"})]}),(0,d.jsxs)("div",{className:"modal-body",children:[(0,d.jsxs)("div",{className:"form-group",children:[(0,d.jsx)("label",{htmlFor:"name",children:"Name"}),(0,d.jsx)("input",{type:"text",id:"name",name:"name",value:o.name,onChange:x,placeholder:"Enter user's name",required:!0,disabled:u})]}),(0,d.jsxs)("div",{className:"form-group",children:[(0,d.jsx)("label",{htmlFor:"email",children:"Email"}),(0,d.jsx)("input",{type:"email",id:"email",name:"email",value:o.email,onChange:x,placeholder:"Enter user's email",required:!0,disabled:u})]}),(0,d.jsxs)("div",{className:"form-group password-group",children:[" ",(0,d.jsx)("label",{htmlFor:"password",children:"Password"}),(0,d.jsxs)("div",{className:"password-input-wrapper",children:[(0,d.jsx)("input",{type:h?"text":"password",id:"password",name:"password",value:o.password,onChange:x,placeholder:"Enter password",required:!0,disabled:u}),(0,d.jsx)("button",{type:"button",className:"password-toggle-btn",onClick:()=>{p(!h)},disabled:u,children:h?(0,d.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:"lucide lucide-eye-off",children:[(0,d.jsx)("path",{d:"M9.88 9.88a3 3 0 1 0 4.24 4.24"}),(0,d.jsx)("path",{d:"M10.73 5.08A10.43 10.43 0 0 1 12 5c7 0 10 7 10 7a13.16 13.16 0 0 1-1.67 2.68"}),(0,d.jsx)("path",{d:"M6.61 6.61A13.52 13.52 0 0 0 2 12s3 7 10 7a9.74 9.74 0 0 0 5.39-1.61"}),(0,d.jsx)("line",{x1:"2",x2:"22",y1:"2",y2:"22"})]}):(0,d.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:"lucide lucide-eye",children:[(0,d.jsx)("path",{d:"M2 12s3-7 10-7 10 7 10 7-3 7-10 7-10-7-10-7Z"}),(0,d.jsx)("circle",{cx:"12",cy:"12",r:"3"})]})})]})]}),(0,d.jsxs)("div",{className:"form-group",children:[(0,d.jsx)("label",{htmlFor:"status",children:"Status"}),(0,d.jsxs)("select",{id:"status",name:"status",value:o.status,onChange:x,required:!0,disabled:u,children:[(0,d.jsx)("option",{value:"active",children:"Active"}),(0,d.jsx)("option",{value:"not active",children:"Not Active"})]})]}),(0,d.jsxs)("div",{className:"form-group permissions-group",children:[(0,d.jsx)("label",{children:"Permissions"}),(0,d.jsx)("div",{className:"permissions-grid",children:["view_dashboard","view_users","add_users","edit_users","view_brands","add_brands","edit_brands","view_investors","add_investors","view_leads","view_marketing_inquiries","view_buy_business_inquiries","view_brand_inquiries","view_brand_dashboard","view_brand_profile","upload_brand_docs","view_sell_business_inquiries","view_lease_properties","view_partner_inquiries","view_newsletter","view_faq","view_events","view_inhouse_brand","add_inhouse_brand","view_inhouse_investor","add_inhouse_investor"].map(e=>(0,d.jsxs)("div",{className:"permission-item",children:[(0,d.jsx)("input",{type:"checkbox",id:"perm-".concat(e),name:"permissions",value:e,checked:o.permissions.includes(e),onChange:j,disabled:u}),(0,d.jsx)("label",{htmlFor:"perm-".concat(e),children:e.replace(/_/g," ")})]},e))})]})]}),(0,d.jsxs)("div",{className:"modal-footer",children:[(0,d.jsx)("button",{className:"save-btn",onClick:async()=>{const{name:e,email:s,password:r,status:t,permissions:d}=o;if(!e||!s||!r||!t)return void i.oR.error("All fields (except permissions) are required.");if(u)return;m(!0);const c={name:e,email:s,password:r,status:t,permissions:d};try{const e=await fetch((0,l.e)("add-user.php"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(c)}),s=await e.text(),r=JSON.parse(s);r.success?(i.oR.success(r.message),n(),a()):i.oR.error(r.message||"Failed to add user.")}catch(h){i.oR.error("API error adding user: "+h.message),console.error("AddUserModal: Error during API call:",h)}finally{m(!1)}},disabled:u,children:u?"Saving...":"Save User"}),(0,d.jsx)("button",{className:"cancel-btn",onClick:a,disabled:u,children:"Cancel"})]})]})}):null}function u(){const[e,s]=(0,t.useState)([]),[a,u]=(0,t.useState)(!0),[m,h]=(0,t.useState)(null),[p,x]=(0,t.useState)(!1),[j,v]=(0,t.useState)({name:"",email:"",password:"",status:"active"}),[g,b]=(0,t.useState)(null),[w,N]=(0,t.useState)(""),[f,_]=(0,t.useState)(""),[y,C]=(0,t.useState)(""),A=(0,t.useCallback)(async()=>{u(!0),h(null);try{const e=await fetch((0,l.e)("get-users.php"));if(!e.ok){const s=await e.json();throw new Error(s.message||"HTTP error! status: ".concat(e.status))}const a=await e.json();a.success?(s(a.data),i.oR.success("Users loaded successfully!")):(i.oR.error(a.message||"Failed to fetch users."),h(a.message||"Failed to fetch users."))}catch(e){i.oR.error("Network error or API issue: "+e.message),h("Network error or API issue: "+e.message),console.error("Error fetching users:",e)}finally{u(!1)}},[]);(0,t.useEffect)(()=>{A()},[A]);const k=()=>{b(null),N(""),_(""),C("")};return(0,d.jsxs)("div",{className:"dashboard-layout",children:[(0,d.jsx)(o.A,{}),(0,d.jsxs)("div",{className:"main-content user-list-container",children:[(0,d.jsx)(i.N9,{position:"top-right",autoClose:3e3,hideProgressBar:!1,newestOnTop:!1,closeOnClick:!0,rtl:!1,pauseOnFocusLoss:!0,draggable:!0,pauseOnHover:!0}),(0,d.jsxs)("div",{className:"user-list-header",children:[(0,d.jsx)("h2",{className:"user-list-title",children:"User List"}),(0,d.jsxs)("button",{className:"add-user-btn",onClick:()=>x(!0),children:[(0,d.jsx)(n.OiG,{})," Add User"]})]}),a?(0,d.jsx)("div",{className:"status-message loading-message",children:"Loading users..."}):m?(0,d.jsxs)("div",{className:"status-message error-message",children:["Error: ",m]}):0===e.length?(0,d.jsx)("div",{className:"status-message no-data-message",children:"No users found."}):(0,d.jsx)("div",{className:"table-wrapper",children:(0,d.jsxs)("table",{className:"user-table",children:[(0,d.jsx)("thead",{children:(0,d.jsxs)("tr",{children:[(0,d.jsx)("th",{children:"ID"}),(0,d.jsxs)("th",{children:[(0,d.jsx)(n.maD,{className:"table-icon"})," Email"]}),(0,d.jsxs)("th",{children:[(0,d.jsx)(n.NBi,{className:"table-icon"})," Name"]}),(0,d.jsxs)("th",{children:[(0,d.jsx)(n.JhU,{className:"table-icon"})," Password"]}),(0,d.jsxs)("th",{children:[(0,d.jsx)(n.A7C,{className:"table-icon"})," Status"]}),(0,d.jsxs)("th",{children:[(0,d.jsx)(n.Zu,{className:"table-icon"})," Created At"]}),(0,d.jsx)("th",{children:"Actions"})," "]})}),(0,d.jsx)("tbody",{children:e.map(e=>(0,d.jsxs)("tr",{children:[(0,d.jsx)("td",{children:e.id}),(0,d.jsx)("td",{children:g===e.id?(0,d.jsx)("input",{type:"email",value:f,onChange:e=>_(e.target.value),className:"editable-input"}):e.email}),(0,d.jsx)("td",{children:g===e.id?(0,d.jsx)("input",{type:"text",value:w,onChange:e=>N(e.target.value),className:"editable-input"}):e.name}),(0,d.jsx)("td",{children:"********"})," ",(0,d.jsx)("td",{children:g===e.id?(0,d.jsxs)("select",{value:y,onChange:e=>C(e.target.value),className:"editable-select",children:[(0,d.jsx)("option",{value:"active",children:"Active"}),(0,d.jsx)("option",{value:"not active",children:"Not Active"})]}):(0,d.jsx)("span",{className:"status-badge ".concat("active"===e.status?"status-active":"status-inactive"),children:e.status})}),(0,d.jsx)("td",{children:e.created_at||"N/A"}),(0,d.jsx)("td",{children:g===e.id?(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)("button",{className:"action-btn save-btn",onClick:()=>(async e=>{if(w&&f&&y)if(/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(f))try{const s=await fetch((0,l.e)("update-user.php"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({id:e,name:w,email:f,status:y})}),a=await s.json();a.success?(i.oR.success(a.message),A(),k()):i.oR.error(a.message||"Failed to update user.")}catch(s){i.oR.error("API error updating user: "+s.message),console.error("Error updating user:",s)}else i.oR.error("Please enter a valid email address.");else i.oR.error("Name, Email, and Status cannot be empty.")})(e.id),title:"Save Changes",children:(0,d.jsx)(n.dIn,{})}),(0,d.jsx)("button",{className:"action-btn cancel-btn",onClick:k,title:"Cancel Edit",children:(0,d.jsx)(n.QCr,{})})]}):(0,d.jsx)("button",{className:"action-btn edit-btn",onClick:()=>(e=>{b(e.id),N(e.name),_(e.email),C(e.status)})(e),title:"Edit User",children:(0,d.jsx)(n.uO9,{})})})]},e.id))})]})}),p&&(0,d.jsx)(c,{isOpen:p,onClose:()=>x(!1),onSave:async()=>{const{name:e,email:s,password:a,status:r}=j;if(e&&s&&a&&r)try{const e=await fetch((0,l.e)("add-user.php"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(j)}),s=await e.json();s.success?(i.oR.success(s.message),x(!1),v({name:"",email:"",password:"",status:"active"}),A()):i.oR.error(s.message||"Failed to add user.")}catch(t){i.oR.error("API error adding user: "+t.message),console.error("Error adding user:",t)}else i.oR.error("All fields are required.")},form:j,handleFormChange:e=>{v((0,r.A)((0,r.A)({},j),{},{[e.target.name]:e.target.value}))}})]})]})}}}]);
//# sourceMappingURL=9506.842db23e.chunk.js.map