"use strict";(self.webpackChunkmyapp=self.webpackChunkmyapp||[]).push([[3402],{742:()=>{},4861:()=>{},5495:(e,s,a)=>{a.r(s),a.d(s,{default:()=>j});var t=a(5043),l=a(7488),r=a(184),n=(a(2342),a(9379)),i=a(2270),o=a(3862),c=a(579);const d=[{value:"active",label:"Active"},{value:"not active",label:"Not Active"}],m=(e,s)=>e.find(e=>e.value===s),u=(e,s,a,t,r)=>e.name.trim()?e.user_name.trim()?/^\d{10}$/.test(e.number)?/\S+@\S+\.\S+/.test(e.email)?r||e.password&&!(e.password.length<8)?s?a?!!t||l.oR.error("Please select a status.")&&!1:l.oR.error("Please select a city.")&&!1:l.oR.error("Please select a state.")&&!1:l.oR.error("Password must be at least 8 characters.")&&!1:l.oR.error("A valid email address is required.")&&!1:l.oR.error("A valid 10-digit mobile number is required.")&&!1:l.oR.error("User Name is required.")&&!1:l.oR.error("Name is required.")&&!1;function h(e){let{show:s,onClose:a,onFormSubmissionSuccess:h,editingInvestor:v}=e;const[j,x]=(0,t.useState)([]),[p,b]=(0,t.useState)([]),[f,N]=(0,t.useState)({name:"",number:"",email:"",password:"",user_name:""}),[g,w]=(0,t.useState)(null),[S,y]=(0,t.useState)(null),[A,C]=(0,t.useState)(null),[_,R]=(0,t.useState)(!1),k=!!v;(0,t.useEffect)(()=>{s&&fetch((0,o.e)("get-indian-states.php")).then(e=>e.json()).then(e=>x(e.map(e=>({value:e.id,label:e.name})))).catch(()=>l.oR.error("Failed to load states."))},[s]),(0,t.useEffect)(()=>{if(!g)return b([]),void y(null);fetch("".concat((0,o.e)("get-cities.php"),"?state_id=").concat(g.value)).then(e=>e.json()).then(e=>{const s=e.map(e=>({value:e.id,label:e.name}));if(b(s),null!==v&&void 0!==v&&v.city_id){const e=m(s,v.city_id);e&&y(e)}}).catch(()=>l.oR.error("Failed to load cities."))},[g,v]),(0,t.useEffect)(()=>{s&&(v?(N({name:v.name||"",number:v.mobile||"",email:v.email||"",password:"",user_name:v.user_name||""}),w(m(j,v.state_id)),C(m(d,v.status))):(N({name:"",number:"",email:"",password:"",user_name:""}),w(null),y(null),C(null)))},[v,j,s]);if(!s)return null;const P=k?"Update Investor":"Add New Investor",E=k?"Update Investor":"Add Investor";return(0,c.jsx)("div",{className:"modal-overlay",onClick:a,children:(0,c.jsxs)("div",{className:"modal-content",onClick:e=>e.stopPropagation(),children:[(0,c.jsxs)("div",{className:"modal-header",children:[(0,c.jsx)("h2",{children:P}),(0,c.jsx)("button",{className:"modal-close-btn",onClick:a,children:(0,c.jsx)(r.QCr,{})})]}),(0,c.jsxs)("form",{onSubmit:async e=>{if(e.preventDefault(),_)return;if(!u(f,g,S,A,k))return;R(!0);const s={name:f.name,mobile:f.number,email:f.email,state_id:g.value,city_id:S.value,status:A.value,user_name:f.user_name};k?s.id=v.id:s.password=f.password;const t=k?(0,o.e)("update-offline-investor.php"):(0,o.e)("add-offline-investor.php");console.log("Submitting to:",t,"with payload:",JSON.stringify(s));try{const e=await fetch(t,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(s)}),r=await e.json();r.success?(l.oR.success(r.message),h(),a()):l.oR.error(r.message||"Something went wrong.")}catch(r){l.oR.error("\ud83d\udeab Server error. Please try again."),console.error(r)}finally{R(!1)}},children:[(0,c.jsxs)("div",{className:"form-row",children:[(0,c.jsxs)("div",{className:"form-group",children:[(0,c.jsx)(r.x$1,{className:"form-icon"}),(0,c.jsx)("input",{type:"text",placeholder:"Name",value:f.name,onChange:e=>N((0,n.A)((0,n.A)({},f),{},{name:e.target.value}))})]}),(0,c.jsxs)("div",{className:"form-group",children:[(0,c.jsx)(r.maD,{className:"form-icon"}),(0,c.jsx)("input",{type:"email",placeholder:"Email",value:f.email,onChange:e=>N((0,n.A)((0,n.A)({},f),{},{email:e.target.value}))})]})]}),(0,c.jsxs)("div",{className:"form-row",children:[(0,c.jsxs)("div",{className:"form-group",children:[(0,c.jsx)(r.Cab,{className:"form-icon"}),(0,c.jsx)("input",{type:"tel",placeholder:"Mobile Number",value:f.number,onChange:e=>N((0,n.A)((0,n.A)({},f),{},{number:e.target.value}))})]}),(0,c.jsxs)("div",{className:"form-group",children:[(0,c.jsx)(r.JhU,{className:"form-icon"}),(0,c.jsx)("input",{type:"password",placeholder:"Password",value:f.password,onChange:e=>N((0,n.A)((0,n.A)({},f),{},{password:e.target.value})),disabled:k})]})]}),(0,c.jsxs)("div",{className:"form-row",children:[(0,c.jsxs)("div",{className:"form-group select-group",children:[(0,c.jsx)(r.vq8,{className:"form-icon"}),(0,c.jsx)(i.Ay,{options:j,value:g,onChange:w,placeholder:"Select State"})]}),(0,c.jsxs)("div",{className:"form-group select-group",children:[(0,c.jsx)(r.zsO,{className:"form-icon"}),(0,c.jsx)(i.Ay,{options:p,value:S,onChange:y,placeholder:"Select City",isDisabled:!g})]})]}),(0,c.jsxs)("div",{className:"form-row",children:[(0,c.jsxs)("div",{className:"form-group select-group",children:[(0,c.jsx)(r.__w,{className:"form-icon"}),(0,c.jsx)(i.Ay,{options:d,value:A,onChange:C,placeholder:"Select Status"})]}),(0,c.jsxs)("div",{className:"form-group",children:[(0,c.jsx)(r.x$1,{className:"form-icon"}),(0,c.jsx)("input",{type:"text",placeholder:"User Name",value:f.user_name,onChange:e=>N((0,n.A)((0,n.A)({},f),{},{user_name:e.target.value}))})]})]}),(0,c.jsx)("button",{type:"submit",className:"submit-btn",disabled:_,children:_?"Processing...":E})]})]})})}a(742),a(4861);var v=a(8537);function j(){const[e,s]=(0,t.useState)([]),[a,n]=(0,t.useState)(!0),[i,d]=(0,t.useState)(null),[m,u]=(0,t.useState)(!1),[j,x]=(0,t.useState)(null),p=(0,t.useCallback)(async()=>{n(!0);try{const e=await fetch((0,o.e)("get-offline-investors.php"));if(!e.ok)throw new Error("HTTP error! status: ".concat(e.status));const a=await e.json();a.success?(s(a.data),d(null)):(l.oR.error(a.message||"Failed to fetch investors."),d(a.message))}catch(e){l.oR.error("\ud83d\udeab Network error. Please check your server connection."),d(e.message)}finally{n(!1)}},[]);(0,t.useEffect)(()=>{p()},[p]);const b=()=>{u(!1),x(null)};return a?(0,c.jsxs)("div",{className:"dashboard-container",children:[(0,c.jsx)(v.A,{}),(0,c.jsx)("div",{className:"main-content",children:(0,c.jsxs)("div",{className:"investor-table-container",children:[(0,c.jsx)("h2",{className:"table-title",children:"Offline Investors"}),(0,c.jsx)("div",{className:"loading",children:"Loading investors..."})]})})]}):i?(0,c.jsxs)("div",{className:"dashboard-container",children:[(0,c.jsx)(v.A,{}),(0,c.jsx)("div",{className:"main-content",children:(0,c.jsxs)("div",{className:"investor-table-container",children:[(0,c.jsx)("h2",{className:"table-title",children:"Offline Investors"}),(0,c.jsxs)("div",{className:"error",children:["Error: ",i]})]})})]}):(0,c.jsxs)("div",{className:"dashboard-container",children:[(0,c.jsx)(v.A,{}),(0,c.jsxs)("div",{className:"main-content",children:[(0,c.jsx)(l.N9,{position:"top-right",autoClose:3e3}),(0,c.jsxs)("div",{className:"investor-table-container",children:[(0,c.jsxs)("div",{className:"table-header",children:[(0,c.jsx)("h2",{className:"table-title",children:"Offline Investors"}),(0,c.jsxs)("button",{className:"add-investor-btn",onClick:()=>{x(null),u(!0)},children:[(0,c.jsx)(r.E5P,{className:"btn-icon"}),"Add Investor"]})]}),0===e.length?(0,c.jsx)("div",{className:"no-data",children:"No investors found."}):(0,c.jsx)("div",{className:"table-wrapper",children:(0,c.jsxs)("table",{children:[(0,c.jsx)("thead",{children:(0,c.jsxs)("tr",{children:[(0,c.jsx)("th",{children:"Name"}),(0,c.jsx)("th",{children:"Mobile"}),(0,c.jsx)("th",{children:"Email"}),(0,c.jsx)("th",{children:"Status"}),(0,c.jsx)("th",{children:"Mode"}),(0,c.jsx)("th",{children:"Actions"})]})}),(0,c.jsx)("tbody",{children:e.map(e=>(0,c.jsxs)("tr",{children:[(0,c.jsx)("td",{"data-label":"Name",children:e.name}),(0,c.jsx)("td",{"data-label":"Mobile",children:e.mobile}),(0,c.jsx)("td",{"data-label":"Email",children:e.email}),(0,c.jsx)("td",{"data-label":"Status",className:"active"===e.status?"status-active":"status-not-active",children:e.status}),(0,c.jsx)("td",{"data-label":"Mode",children:e.mode}),(0,c.jsxs)("td",{"data-label":"Actions",children:[(0,c.jsx)("button",{className:"action-btn edit-btn",onClick:()=>(e=>{x(e),u(!0)})(e),children:"Edit"}),(0,c.jsx)("button",{className:"action-btn delete-btn",children:"Delete"})]})]},e.id))})]})})]}),(0,c.jsx)(h,{show:m,onClose:b,onFormSubmissionSuccess:()=>{p(),b()},editingInvestor:j})]})]})}}}]);
//# sourceMappingURL=3402.41071418.chunk.js.map