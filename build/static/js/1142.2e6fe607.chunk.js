"use strict";(self.webpackChunkmyapp=self.webpackChunkmyapp||[]).push([[1142],{3113:()=>{},5592:(e,s,a)=>{a.r(s),a.d(s,{default:()=>c});var t=a(9379),n=a(5043),l=(a(3113),a(8537)),i=a(3862),r=a(579);function c(){const[e,s]=(0,n.useState)([]),[a,c]=(0,n.useState)(null),[o,d]=(0,n.useState)(!0),[h,u]=(0,n.useState)(null),[p,x]=(0,n.useState)({}),[g,j]=(0,n.useState)(!1),[m,v]=(0,n.useState)(null),[f,b]=(0,n.useState)([]),[y,w]=(0,n.useState)(""),[S,N]=(0,n.useState)(!1),[C,A]=(0,n.useState)(!1),[k,I]=(0,n.useState)(1),[F,P]=(0,n.useState)(10),E=["Contacted","Qualified","Disqualified","Working","Prospecting","Negotiation","Closed Won","Closed Lost"],O=(e,s,a)=>{x(n=>(0,t.A)((0,t.A)({},n),{},{[e]:(0,t.A)((0,t.A)({},n[e]),{},{[s]:a})}))},D=(e,s,a)=>{var t,n,l;const i=null!==(t=null!==(n=null===(l=p[e])||void 0===l?void 0:l[s])&&void 0!==n?n:a)&&void 0!==t?t:"";return"stage"===s?(0,r.jsxs)("select",{value:i,onChange:a=>O(e,s,a.target.value),children:[(0,r.jsx)("option",{value:"",children:"Select Stage"}),E.map(e=>(0,r.jsx)("option",{value:e,children:e},e))]}):s.toLowerCase().includes("date")?(0,r.jsx)("input",{type:"date",value:i,onChange:a=>O(e,s,a.target.value)}):s.toLowerCase().includes("time")?(0,r.jsx)("input",{type:"time",value:i,onChange:a=>O(e,s,a.target.value)}):(0,r.jsx)("input",{type:"text",value:i,onChange:a=>O(e,s,a.target.value)})},M=e=>{v(e),w(""),(async()=>{try{const e=await fetch((0,i.e)("get-user-name.php")),s=await e.json();b((null===s||void 0===s?void 0:s.data)||[])}catch(e){console.error("Failed to fetch users",e),b([])}})()},T=async()=>{if(y)try{N(!0);const e={investor_id:m,user_id:y},a=await fetch((0,i.e)("assign-inhouse-investor.php"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)}),n=await a.json();a.ok&&n.success?(alert(n.message||"Assigned successfully"),s(e=>e.map(e=>e.id===m?(0,t.A)((0,t.A)({},e),{},{assignedUserId:y}):e)),v(null),w("")):alert(n.message||"Failed to assign")}catch(e){console.error("Assign error:",e),alert("Something went wrong while assigning.")}finally{N(!1)}else alert("Please select a user first")},U=async()=>{try{const e=localStorage.getItem("adminId")||0,a=await fetch((0,i.e)("get-inhouse-investors.php?user_id=".concat(e))),t=await a.json();s(Array.isArray(t)?t:[]),d(!1)}catch(e){console.error("Investor fetch error:",e),u("Failed to fetch investors."),d(!1)}};(0,n.useEffect)(()=>{U()},[]);const L=Math.ceil(e.length/F),_=k*F,q=_-F,J=e.slice(q,_);return(0,r.jsxs)("div",{className:"dashboard-container",children:[(0,r.jsx)(l.A,{}),(0,r.jsxs)("div",{className:"main-content",children:[(0,r.jsx)("h2",{className:"table-title",children:"Investor Inquiries"}),"1"==localStorage.getItem("adminId")&&(0,r.jsxs)("div",{className:"upload-box",children:[(0,r.jsxs)("label",{className:"upload-label",children:["Upload Excel:",(0,r.jsx)("input",{type:"file",accept:".xlsx,.xls",onChange:async e=>{const s=e.target.files[0];if(!s)return;const a=new FormData;a.append("file",s);try{A(!0);const e=await fetch((0,i.e)("upload-investors-excel.php"),{method:"POST",body:a}),s=await e.json();e.ok&&s.success?(alert("Excel uploaded successfully!"),U()):alert(s.message||"Upload failed")}catch(t){console.error("Excel upload error:",t),alert("Something went wrong while uploading Excel.")}finally{A(!1),e.target.value=""}},disabled:C})]}),C&&(0,r.jsx)("span",{className:"uploading-text",children:"Uploading..."})]}),o&&(0,r.jsx)("div",{className:"loading",children:"Loading..."}),h&&(0,r.jsx)("div",{className:"error",children:h}),!o&&!h&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("div",{className:"table-wrapper",children:(0,r.jsxs)("table",{className:"inquiry-table",children:[(0,r.jsx)("thead",{children:(0,r.jsxs)("tr",{children:[(0,r.jsx)("th",{children:"ID"}),(0,r.jsx)("th",{children:"Name"}),(0,r.jsx)("th",{children:"Contact"}),(0,r.jsx)("th",{children:"Email"}),(0,r.jsx)("th",{children:"Investment Budget"}),(0,r.jsx)("th",{children:"Stage"}),(0,r.jsx)("th",{children:"Actions"})]})}),(0,r.jsx)("tbody",{children:J.map(e=>(0,r.jsxs)(n.Fragment,{children:[(0,r.jsxs)("tr",{className:"summary-row",children:[(0,r.jsx)("td",{children:e.id}),(0,r.jsx)("td",{children:e.name}),(0,r.jsx)("td",{children:e.contact}),(0,r.jsx)("td",{children:e.email}),(0,r.jsx)("td",{children:e.investment_budget||"N/A"}),(0,r.jsx)("td",{children:e.stage||"N/A"}),(0,r.jsxs)("td",{children:[(0,r.jsx)("button",{onClick:()=>{return s=e.id,c(a===s?null:s),void v(null);var s},className:"expand-btn",children:a===e.id?"Hide Details":"View Details"}),"1"===localStorage.getItem("adminId")&&(0,r.jsx)("button",{onClick:()=>M(e.id),className:"assign-btn",children:"Assign"})]})]}),a===e.id&&(0,r.jsx)("tr",{className:"details-row",children:(0,r.jsx)("td",{colSpan:"7",children:(0,r.jsxs)("div",{className:"details-box",children:[m===e.id&&f.length>0&&(0,r.jsxs)("div",{className:"assign-box",children:[(0,r.jsxs)("label",{children:["Assign to:",(0,r.jsxs)("select",{value:y,onChange:e=>w(e.target.value),children:[(0,r.jsx)("option",{value:"",children:"Select User"}),f.map(e=>(0,r.jsx)("option",{value:e.id,children:e.name},e.id))]})]}),(0,r.jsx)("button",{onClick:T,className:"confirm-btn",disabled:S,children:S?"Assigning...":"Confirm"})]}),Object.keys(e).map(s=>"id"===s?null:(0,r.jsxs)("p",{children:[(0,r.jsxs)("strong",{children:[s,":"]})," ",D(e.id,s,e[s])]},s)),(0,r.jsx)("button",{onClick:()=>(async e=>{try{j(!0);const a=(0,t.A)({id:e},p[e]),n=await fetch((0,i.e)("update-inhouse-investor.php"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(a)}),l=await n.json();n.ok&&l.success?(alert(l.message||"Saved successfully"),s(s=>s.map(s=>s.id===e?(0,t.A)((0,t.A)({},s),p[e]):s)),x(s=>{const a=(0,t.A)({},s);return delete a[e],a})):alert(l.message||"Failed to save data")}catch(a){console.error("Save error:",a),alert("Something went wrong while saving.")}finally{j(!1)}})(e.id),className:"save-btn",disabled:g,children:g?"Saving...":"Save"})]})})})]},e.id))})]})}),L>1&&(0,r.jsxs)("div",{className:"pagination-wrapper",children:[(0,r.jsxs)("div",{className:"rows-per-page",children:[(0,r.jsx)("label",{htmlFor:"rows",children:"Rows per page:"}),(0,r.jsxs)("select",{id:"rows",value:F,onChange:e=>{P(Number(e.target.value)),I(1)},children:[(0,r.jsx)("option",{value:5,children:"5"}),(0,r.jsx)("option",{value:10,children:"10"}),(0,r.jsx)("option",{value:20,children:"20"}),(0,r.jsx)("option",{value:50,children:"50"})]})]}),(0,r.jsxs)("div",{className:"pagination",children:[(0,r.jsx)("button",{onClick:()=>I(e=>Math.max(e-1,1)),disabled:1===k,children:"Prev"}),(()=>{const e=[];if(L<=10)for(let s=1;s<=L;s++)e.push(s);else{let s=Math.max(2,k-2),a=Math.min(L-3,k+2);e.push(1),s>2&&e.push("...");for(let t=s;t<=a;t++)e.push(t);a<L-3&&e.push("...");for(let t=L-2;t<=L;t++)e.push(t)}return e.map((e,s)=>"..."===e?(0,r.jsx)("span",{className:"dots",children:"..."},s):(0,r.jsx)("button",{className:k===e?"active":"",onClick:()=>I(e),children:e},e))})(),(0,r.jsx)("button",{onClick:()=>I(e=>Math.min(e+1,L)),disabled:k===L,children:"Next"})]}),(0,r.jsxs)("div",{className:"page-info",children:["Page ",k," of ",L]})]})]})]})]})}}}]);
//# sourceMappingURL=1142.2e6fe607.chunk.js.map